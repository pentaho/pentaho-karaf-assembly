<!--
  ~ This program is free software; you can redistribute it and/or modify it under the
  ~ terms of the GNU Lesser General Public License, version 2.1 as published by the Free Software
  ~ Foundation.
  ~
  ~ You should have received a copy of the GNU Lesser General Public License along with this
  ~ program; if not, you can obtain a copy at http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html
  ~ or from the Free Software Foundation, Inc.,
  ~ 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
  ~
  ~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  ~ See the GNU Lesser General Public License for more details.
  ~
  ~ Copyright 2014 - 2017 Hitachi Vantara. All rights reserved.
  -->

<assembly>

  <id>client</id>

  <formats>
    <format>zip</format>
  </formats>

  <fileSets>

    <!-- Expanded Karaf Standard Distribution -->
    <fileSet>
      <directory>target/dependencies/apache-karaf-${karaf.version}</directory>
      <outputDirectory>/</outputDirectory>
      <excludes>
        <exclude>etc/custom.properties</exclude>
        <exclude>etc/startup.properties</exclude>
        <exclude>etc/org.apache.karaf.features.cfg</exclude>
        <exclude>etc/org.apache.karaf.management.cfg</exclude>
        <exclude>etc/org.ops4j.pax.url.mvn.cfg</exclude>
        <exclude>etc/org.apache.karaf.shell.cfg</exclude>
        <exclude>etc/system.properties</exclude>
        <exclude>**/demos/**</exclude>
        <exclude>bin/**</exclude>
        <exclude>LICENSE</exclude>
        <exclude>NOTICE</exclude>
        <exclude>README</exclude>
        <exclude>RELEASE-NOTES</exclude>
        <exclude>karaf-manual*.html</exclude>
        <exclude>karaf-manual*.pdf</exclude>
      </excludes>
    </fileSet>

    <fileSet>
      <directory>src/main/resources/configuration-bundles</directory>
      <outputDirectory>/${configuration-bundles.target}</outputDirectory>
      <fileMode>0644</fileMode>
    </fileSet>

    <!-- copy the exploded configuration bundles to the configurations' deploy folder -->
    <fileSet>
      <directory>${configuration-bundles.unpacked}</directory>
      <outputDirectory>/${configuration-bundles.target}</outputDirectory>
      <fileMode>0644</fileMode>
    </fileSet>

    <fileSet>
      <directory>src/main/distribution</directory>
      <outputDirectory>/</outputDirectory>
      <fileMode>0644</fileMode>
    </fileSet>
    <fileSet>
      <directory>target/classes/etc</directory>
      <outputDirectory>/etc/</outputDirectory>
      <lineEnding>unix</lineEnding>
      <fileMode>0644</fileMode>
      <excludes>
        <exclude>**/*.formatted</exclude>
      </excludes>
    </fileSet>
    <fileSet>
      <directory>target/classes/etc-client</directory>
      <outputDirectory>/etc/</outputDirectory>
      <lineEnding>unix</lineEnding>
      <fileMode>0644</fileMode>
      <excludes>
        <exclude>**/*.formatted</exclude>
      </excludes>
    </fileSet>

    <fileSet>
      <directory>target/classes/client-extras</directory>
      <outputDirectory>/</outputDirectory>
      <lineEnding>unix</lineEnding>
      <fileMode>0644</fileMode>
      <excludes>
        <exclude>**/*.formatted</exclude>
      </excludes>
    </fileSet>


    <fileSet>
      <directory>target/classes/deploy</directory>
      <outputDirectory>/deploy/</outputDirectory>
      <lineEnding>unix</lineEnding>
      <fileMode>0644</fileMode>
      <excludes>
        <exclude>**/*.formatted</exclude>
      </excludes>
    </fileSet>

    <fileSet>
      <directory>target/classes/deploy-client</directory>
      <outputDirectory>/deploy/</outputDirectory>
      <lineEnding>unix</lineEnding>
      <fileMode>0644</fileMode>
      <excludes>
        <exclude>**/*.formatted</exclude>
      </excludes>
    </fileSet>

    <fileSet>
      <directory>target/pentaho-client-features-repo</directory>
      <outputDirectory>/system</outputDirectory>
      <excludes>
        <!-- Excluding the pentaho-karaf-overrides feature as it is only used during build time
             to copy the overriding bundles to the karaf/system folder. -->
        <exclude>org/pentaho/karaf/pentaho-karaf-overrides/**</exclude>

        <!-- Add the bundles that are overridden in etc/override.properties here so that they are excluded
             from the final karaf assembly -->
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-webmvc/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-beans/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-core/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-context/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-context-support/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-expression/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-aop/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-aspects/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-instrument/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-jdbc/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-jms/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-struts/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-test/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-orm/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-tx/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-oxm/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-web/3.2.18.RELEASE_1/**</exclude>
        <exclude>org/apache/servicemix/bundles/org.apache.servicemix.bundles.spring-webmvc-portlet/3.2.18.RELEASE_1/**</exclude>
      </excludes>
    </fileSet>

  </fileSets>

</assembly>
